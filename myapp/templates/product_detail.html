{% load static %}
<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>{{ product.name }} | {{ home_data.site_name }}</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- Bootstrap -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

  <style>
    body { background: #f5f5f5; }
    .product-container { background: #fff; border-radius: 8px; }
    .price { font-size: 28px; font-weight: bold; color: #f68b1e; }
    .old-price { text-decoration: line-through; color: #888; font-size: 14px; }
    .badge-promo { background: #e63946; }
    .btn-buy { background: #f68b1e; border: none; font-weight: bold; }
    .btn-buy:hover { background: #e07c1a; }
    .info-box { border-top: 1px solid #eee; padding-top: 15px; margin-top: 15px; }
    .seller-box { background: #fafafa; border-radius: 6px; padding: 12px; }
  </style>
</head>

<body>

<div class="container py-4">

  <!-- ===== BREADCRUMB ===== -->
  <nav aria-label="breadcrumb">
    <ol class="breadcrumb small">
      <li class="breadcrumb-item"><a href="{% url 'home' %}">Accueil</a></li>
      <li class="breadcrumb-item active">{{ product.name }}</li>
    </ol>
  </nav>

  <div class="row g-4 product-container p-3 shadow-sm">

    <!-- ===== IMAGE ===== -->
    <div class="col-md-5 text-center">
      {% if product.image %}
      <img src="{{ product.image.url }}" class="img-fluid rounded">
      {% else %}
      <img src="{% static 'no-image.png' %}" class="img-fluid rounded">
      {% endif %}
    </div>

    <!-- ===== INFOS PRODUIT ===== -->
    <div class="col-md-4">
      <h4>{{ product.name }}</h4>

      {% if product.quantity > 0 %}
      <span class="badge bg-success mb-2">En stock</span>
      {% else %}
      <span class="badge bg-danger mb-2">Rupture de stock</span>
      {% endif %}

      <div class="price mt-2">{{ product.price }} FCFA</div>

      {% if product.old_price %}
      <div class="old-price">Avant : {{ product.old_price }} FCFA</div>
      <span class="badge badge-promo text-white mt-1">Promo</span>
      {% endif %}

      <div class="info-box">
        <p class="mb-1">üöö Livraison rapide</p>
        <p class="mb-1">üîÑ Retour sous 7 jours</p>
        <p class="mb-1">üõ°Ô∏è Garantie vendeur</p>
      </div>
    </div>

    <!-- ===== ACHAT ===== -->
    <div class="col-md-3">
      <div class="seller-box shadow-sm">

        <h6 class="fw-bold">Vendu par</h6>
        <p class="mb-1">{{ home_data.site_name }}</p>
        <small class="text-muted">Paiement s√©curis√©</small>

        {% if product.quantity > 0 %}
        <a href="{% url 'commande' product.id %}" class="btn btn-buy w-100 mt-3">
          üõí Commander
        </a>
        {% else %}
        <button class="btn btn-secondary w-100 mt-3" disabled>
          Indisponible
        </button>
        {% endif %}

        <a href="{% url 'home' %}" class="btn btn-outline-secondary w-100 mt-2">
          ‚¨Ö Continuer vos achats
        </a>

      </div>
    </div>

  </div>

  <!-- ===== DESCRIPTION ===== -->
  <div class="bg-white rounded shadow-sm mt-4 p-4">
    <h5>Description</h5>
    <p class="text-muted">
      {{ product.description|default:"Aucune description disponible." }}
    </p>
  </div>

<!-- ===== PRODUITS SIMILAIRES ===== -->
<div class="bg-white rounded shadow-sm mt-4 p-4">
  <h5 class="mb-3">Produits similaires</h5>

  <div class="row g-3">
    {% for item in similar_products %}
    <div class="col-6 col-md-3">
      <div class="card h-100">

        {% if item.image %}
        <img src="{{ item.image.url }}" class="card-img-top" style="height:160px; object-fit:contain;">
        {% endif %}

        <div class="card-body d-flex flex-column">
          <h6 class="small">{{ item.name|truncatechars:40 }}</h6>
          <strong class="text-danger">{{ item.price }} FCFA</strong>

          <a href="{% url 'product_detail' item.id %}"
             class="btn btn-sm btn-outline-primary mt-auto">
            Voir d√©tails
          </a>
        </div>

      </div>
    </div>
    {% empty %}
    <p class="text-muted">Aucun produit similaire trouv√©.</p>
    {% endfor %}
  </div>
</div>


</div>

</body>
</html>
